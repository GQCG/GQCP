\hypertarget{_shell_set_8hpp_source}{}\doxysection{Shell\+Set.\+hpp}
\label{_shell_set_8hpp_source}\index{/\_\_w/GQCP/GQCP/gqcp/include/Basis/ScalarBasis/ShellSet.hpp@{/\_\_w/GQCP/GQCP/gqcp/include/Basis/ScalarBasis/ShellSet.hpp}}
\mbox{\hyperlink{_shell_set_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ GQCG-\/GQCP.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Copyright\ (C)\ 2017-\/2020\ \ the\ GQCG\ developers}}
\DoxyCodeLine{00004\ \textcolor{comment}{//}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ GQCG-\/GQCP\ is\ free\ software:\ you\ can\ redistribute\ it\ and/or\ modify}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ it\ under\ the\ terms\ of\ the\ GNU\ Lesser\ General\ Public\ License\ as\ published\ by}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ the\ Free\ Software\ Foundation,\ either\ version\ 3\ of\ the\ License,\ or}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ (at\ your\ option)\ any\ later\ version.}}
\DoxyCodeLine{00009\ \textcolor{comment}{//}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ GQCG-\/GQCP\ is\ distributed\ in\ the\ hope\ that\ it\ will\ be\ useful,}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ but\ WITHOUT\ ANY\ WARRANTY;\ without\ even\ the\ implied\ warranty\ of}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ MERCHANTABILITY\ or\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE.\ \ See\ the}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ GNU\ Lesser\ General\ Public\ License\ for\ more\ details.}}
\DoxyCodeLine{00014\ \textcolor{comment}{//}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ You\ should\ have\ received\ a\ copy\ of\ the\ GNU\ Lesser\ General\ Public\ License}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ along\ with\ GQCG-\/GQCP.\ \ If\ not,\ see\ <http://www.gnu.org/licenses/>.}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_g_t_o_shell_8hpp}{Basis/ScalarBasis/GTOShell.hpp}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_london_g_t_o_shell_8hpp}{Basis/ScalarBasis/LondonGTOShell.hpp}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_molecule_8hpp}{Molecule/Molecule.hpp}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_homogeneous_magnetic_field_8hpp}{Physical/HomogeneousMagneticField.hpp}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{type__traits_8hpp}{Utilities/type\_traits.hpp}}"{}}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ <initializer\_list>}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_g_q_c_p}{GQCP}}\ \{}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00040\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ \_Shell>}
\DoxyCodeLine{00041\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set}{ShellSet}}\ \{}
\DoxyCodeLine{00042\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{comment}{//\ The\ type\ of\ shell\ that\ this\ shell\ set\ contains.}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a4d526a30292159e7edc9c5bc0225967f}{Shell}}\ =\ \_Shell;}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{comment}{//\ The\ type\ of\ primitives\ that\ this\ shell\ set\ contains.}}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a4434580128915230eabf525c93a56dde}{Primitive}}\ =\ \textcolor{keyword}{typename}\ Shell::Primitive;}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{//\ The\ type\ of\ basis\ functions\ that\ this\ shell\ contains.}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a48ecd4d67ae529405cc6fdd1ca622f9f}{BasisFunction}}\ =\ \textcolor{keyword}{typename}\ Shell::BasisFunction;}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{comment}{//\ The\ collection\ of\ shells\ represented\ by\ a\ vector.}}
\DoxyCodeLine{00055\ \ \ \ \ std::vector<Shell>\ shells;}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00060\ \textcolor{comment}{\ \ \ \ \ *\ \ MARK:\ Constructors}}
\DoxyCodeLine{00061\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00066\ \ \ \ \ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_ab1ff68735ec79d74c9e65b8ac6b46bb8}{ShellSet}}(\textcolor{keyword}{const}\ std::vector<Shell>\&\ shells)\ :}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ shells\ \{shells\}\ \{\}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00075\ \ \ \ \ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_ad364127deebe828f3239656dd510255e}{ShellSet}}(\textcolor{keyword}{const}\ std::initializer\_list<GTOShell>\&\ list)\ :}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ shells\ \{list\}\ \{\}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00080\ \textcolor{comment}{\ \ \ \ \ *\ \ MARK:\ Normalization}}
\DoxyCodeLine{00081\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a4409d48541063e67371594aa305687a9}{embedNormalizationFactors}}()\ \{}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ shell\ :\ this-\/>shells)\ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ shell.embedNormalizationFactor();}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00091\ \ \ \ \ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_aedd598eb82a83d2542b06db08c06cd16}{embedNormalizationFactorsOfPrimitives}}()\ \{}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ shell\ :\ this-\/>shells)\ \{}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ shell.embedNormalizationFactorsOfPrimitives();}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00104\ \ \ \ \ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a81c243c231826670d3f653a758efc4d7}{unEmbedNormalizationFactorsOfPrimitives}}()\ \{}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ shell\ :\ this-\/>shells)\ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ shell.unEmbedNormalizationFactorsOfPrimitives();}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00117\ \ \ \ \ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00121\ \textcolor{comment}{\ \ \ \ \ *\ \ MARK:\ Basis\ functions}}
\DoxyCodeLine{00122\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_abe949af8f29058c15b0f462797b19970}{numberOfBasisFunctions}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ value\ \{\};}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ shell\ :\ this-\/>shells)\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ value\ +=\ shell.numberOfBasisFunctions();}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ value;}
\DoxyCodeLine{00135\ \ \ \ \ \}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00141\ \ \ \ \ std::vector<BasisFunction>\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a6fef0ae32aad408cf32ad8e184705d17}{basisFunctions}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ std::vector<BasisFunction>\ basis\_functions;}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ basis\_functions.reserve(this-\/>\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_abe949af8f29058c15b0f462797b19970}{numberOfBasisFunctions}}());}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ shell\ :\ this-\/>shells)\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ shell\_basis\_functions\ =\ shell.basisFunctions();}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ shell\_basis\_function\ :\ shell\_basis\_functions)\ \{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ basis\_functions.push\_back(shell\_basis\_function);}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ basis\_functions;}
\DoxyCodeLine{00153\ \ \ \ \ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_afe8bd19fea107b47391923d99763ddae}{basisFunctionIndex}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ shell\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Count\ the\ number\ of\ basis\ functions\ before\ the\ given\ index.}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ bf\_index\ \{\};}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ shell\_index;\ i++)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ bf\_index\ +=\ this-\/>shells[i].numberOfBasisFunctions();}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ bf\_index;}
\DoxyCodeLine{00170\ \ \ \ \ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00174\ \textcolor{comment}{\ \ \ \ \ *\ \ MARK:\ General\ information}}
\DoxyCodeLine{00175\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<Shell>\&\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a569efd7b6357946f92b9a603d2b0075b}{asVector}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ this-\/>shells;\ \}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a9b7a4bee7ad1c6a87d3f5d60423f4ae3}{numberOfShells}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ this-\/>shells.size();\ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00190\ \ \ \ \ std::vector<Nucleus>\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_ab4944fd712fc66765ed171dae0827fc3}{nuclei}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Append\ every\ unique\ nucleus\ in\ this\ shell\ set's\ shells.}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ std::vector<Nucleus>\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_ab4944fd712fc66765ed171dae0827fc3}{nuclei}}\ \{\};}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ shell\ :\ this-\/>shells)\ \{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ nucleus\ =\ shell.nucleus();}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ unary\_predicate\ =\ [nucleus](\textcolor{keyword}{const}\ \mbox{\hyperlink{class_g_q_c_p_1_1_nucleus}{Nucleus}}\&\ other)\ \{}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_g_q_c_p_1_1_nucleus_af5828115bf52ad9b213b744ef4716f69}{Nucleus::equalityComparer}}()(nucleus,\ other);}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ p\ =\ std::find\_if(\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_ab4944fd712fc66765ed171dae0827fc3}{nuclei}}.begin(),\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_ab4944fd712fc66765ed171dae0827fc3}{nuclei}}.end(),\ unary\_predicate);}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p\ ==\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_ab4944fd712fc66765ed171dae0827fc3}{nuclei}}.end())\ \{\ \ \textcolor{comment}{//\ If\ the\ nucleus\ is\ unique.}}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_ab4944fd712fc66765ed171dae0827fc3}{nuclei}}.push\_back(nucleus);}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_ab4944fd712fc66765ed171dae0827fc3}{nuclei}};}
\DoxyCodeLine{00208\ \ \ \ \ \}}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a5a5e583e3b3824b70377ef9d045aef38}{maximumAngularMomentum}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Generate\ a\ list\ of\ all\ the\ angular\ momenta\ and\ then\ check\ its\ maximum.}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ std::vector<size\_t>\ angular\_momenta\ \{\};\ \ \textcolor{comment}{//\ This\ will\ contain\ the\ number\ of\ primitives\ for\ each\ of\ the\ shells.}}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ angular\_momenta.reserve(this-\/>\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a9b7a4bee7ad1c6a87d3f5d60423f4ae3}{numberOfShells}}());}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ shell\ :\ this-\/>\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a569efd7b6357946f92b9a603d2b0075b}{asVector}}())\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ angular\_momenta.push\_back(shell.angularMomentum());}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ it\ =\ std::max\_element(angular\_momenta.begin(),\ angular\_momenta.end());\ \ \textcolor{comment}{//\ 'it'\ for\ iterator.}}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *it;}
\DoxyCodeLine{00226\ \ \ \ \ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_af106eaf05bf9defbfc0bac771464ada3}{maximumNumberOfPrimitives}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Generate\ a\ list\ of\ all\ the\ number\ of\ primitives\ momenta\ and\ then\ check\ its\ maximum.}}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ std::vector<size\_t>\ number\_of\_primitives\ \{\};\ \ \textcolor{comment}{//\ This\ will\ contain\ the\ number\ of\ primitives\ for\ each\ of\ the\ shells.}}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ number\_of\_primitives.reserve(this-\/>\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a9b7a4bee7ad1c6a87d3f5d60423f4ae3}{numberOfShells}}());}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ shell\ :\ this-\/>\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a569efd7b6357946f92b9a603d2b0075b}{asVector}}())\ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ number\_of\_primitives.push\_back(shell.contractionSize());}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ it\ =\ std::max\_element(number\_of\_primitives.begin(),\ number\_of\_primitives.end());\ \ \textcolor{comment}{//\ 'it'\ for\ iterator.}}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *it;}
\DoxyCodeLine{00244\ \ \ \ \ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00248\ \textcolor{comment}{\ \ \ \ \ *\ \ MARK:\ London\ modifications}}
\DoxyCodeLine{00249\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Z\ =\ Shell>}
\DoxyCodeLine{00259\ \ \ \ \ \mbox{\hyperlink{namespace_g_q_c_p_a006e5cafd5827d2685c9e0bb7e01cfa2}{enable\_if\_t<std::is\_same<Z,\ GTOShell>::value}},\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set}{ShellSet<LondonGTOShell>}}>\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a1d1daf83f70eced10b131f42c46e736d}{applyLondonModification}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_g_q_c_p_1_1_homogeneous_magnetic_field}{HomogeneousMagneticField}}\&\ B)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Run\ over\ each\ `GTOShell`\ and\ construct\ the\ corresponding\ `LondonGTOShell`.}}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ std::vector<LondonGTOShell>\ london\_shells;}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ london\_shells.reserve(this-\/>\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a9b7a4bee7ad1c6a87d3f5d60423f4ae3}{numberOfShells}}());}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ gto\_shell\ :\ this-\/>\mbox{\hyperlink{class_g_q_c_p_1_1_shell_set_a569efd7b6357946f92b9a603d2b0075b}{asVector}}())\ \{}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_g_q_c_p_1_1_london_g_t_o_shell}{LondonGTOShell}}\ london\_shell\ \{gto\_shell,\ B\};}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ london\_shells.push\_back(london\_shell);}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_g_q_c_p_1_1_shell_set}{ShellSet<LondonGTOShell>}}(london\_shells);}
\DoxyCodeLine{00270\ \ \ \ \ \}}
\DoxyCodeLine{00271\ \};}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \}\ \ \textcolor{comment}{//\ namespace\ GQCP}}

\end{DoxyCode}
