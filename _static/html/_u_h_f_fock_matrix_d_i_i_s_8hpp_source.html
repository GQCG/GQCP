<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GQCP: /__w/GQCP/GQCP/gqcp/include/QCMethod/HF/UHF/UHFFockMatrixDIIS.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GQCP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97189f8bdcb13d91395c09d841162246.html">gqcp</a></li><li class="navelem"><a class="el" href="dir_0f303d9e90ecbf2958f248aff9125567.html">include</a></li><li class="navelem"><a class="el" href="dir_d7d218554e8f7cd1ed4d34252e45a7a6.html">QCMethod</a></li><li class="navelem"><a class="el" href="dir_a7d87e49902b2c5159a2bbbbea962fdc.html">HF</a></li><li class="navelem"><a class="el" href="dir_cb77ee1e6cf10d494adbc9ec9af98407.html">UHF</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">UHFFockMatrixDIIS.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_u_h_f_fock_matrix_d_i_i_s_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// This file is part of GQCG-GQCP.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright (C) 2017-2020  the GQCG developers</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// GQCG-GQCP is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// (at your option) any later version.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// GQCG-GQCP is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// GNU Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// along with GQCG-GQCP.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_step_8hpp.html">Mathematical/Algorithm/Step.hpp</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_d_i_i_s_8hpp.html">Mathematical/Optimization/Accelerator/DIIS.hpp</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_u_h_f_fock_matrix_diagonalization_8hpp.html">QCMethod/HF/UHF/UHFFockMatrixDiagonalization.hpp</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_u_h_f_s_c_f_environment_8hpp.html">QCMethod/HF/UHF/UHFSCFEnvironment.hpp</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_q_c_model_2_h_f_2_u_h_f_8hpp.html">QCModel/HF/UHF.hpp</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_g_q_c_p.html">GQCP</a> {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Scalar&gt;</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html">   39</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html">UHFFockMatrixDIIS</a>:</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keyword">public</span> <a class="code" href="class_g_q_c_p_1_1_step.html">Step</a>&lt;UHFSCFEnvironment&lt;_Scalar&gt;&gt; {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#a3c5cab15d8afe08c7614d893d0aabadd">   43</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#a3c5cab15d8afe08c7614d893d0aabadd">Scalar</a> = _Scalar;</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#a88c1814eddb3914bdd054bcb5614679b">   44</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html">Environment</a> = <a class="code" href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html">UHFSCFEnvironment&lt;Scalar&gt;</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">size_t</span> minimum_subspace_dimension;  <span class="comment">// The minimum number of Fock matrices that have to be in the subspace before enabling DIIS.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">size_t</span> maximum_subspace_dimension;  <span class="comment">// The maximum number of Fock matrices that can be handled by DIIS.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="class_g_q_c_p_1_1_d_i_i_s.html">DIIS&lt;Scalar&gt;</a> diis;  <span class="comment">// The DIIS accelerator.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">     *  CONSTRUCTORS</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#ad2bdf1e167babd76b3d5a6b6c4c0f357">   63</a></span>&#160;    <a class="code" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#ad2bdf1e167babd76b3d5a6b6c4c0f357">UHFFockMatrixDIIS</a>(<span class="keyword">const</span> <span class="keywordtype">size_t</span> minimum_subspace_dimension = 6, <span class="keyword">const</span> <span class="keywordtype">size_t</span> maximum_subspace_dimension = 6) :</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        minimum_subspace_dimension {minimum_subspace_dimension},</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        maximum_subspace_dimension {maximum_subspace_dimension} {}</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">     *  PUBLIC OVERRIDDEN METHODS</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#a0e3a95de68060c280dc8c43e108cc86a">   75</a></span>&#160;    std::string <a class="code" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#a0e3a95de68060c280dc8c43e108cc86a">description</a>()<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Calculate the accelerated alpha- and beta- Fock matrices, and perform a diagonalization step on them.&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#a207ae64b829294f7b15481f7cbd17990">   85</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#a207ae64b829294f7b15481f7cbd17990">execute</a>(<a class="code" href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html">Environment</a>&amp; environment)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">if</span> (environment.<a class="code" href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html#a93c1f0bb1a00de972b2602acf17cae59">error_vectors</a>.size() &lt; this-&gt;minimum_subspace_dimension) {  <span class="comment">// The beta dimension will be the same.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="comment">// No acceleration is possible, so calculate the regular Fock matrices and diagonalize them.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <a class="code" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_calculation.html">UHFFockMatrixCalculation&lt;Scalar&gt;</a>().<a class="code" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_calculation.html#a3477f32fa104205808148d9dd5e156fa">execute</a>(environment);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <a class="code" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_diagonalization.html">UHFFockMatrixDiagonalization&lt;Scalar&gt;</a>().<a class="code" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_diagonalization.html#ae358b2b13f6dcc5299745573298be194">execute</a>(environment);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="comment">// Convert the deques in the environment to vectors that can be accepted by the DIIS accelerator. The total number of elements we can use in DIIS is either the maximum subspace dimension or the number of available error matrices.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> n = std::min(this-&gt;maximum_subspace_dimension, environment.<a class="code" href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html#a93c1f0bb1a00de972b2602acf17cae59">error_vectors</a>.size());</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keyword">const</span> std::vector&lt;SpinResolved&lt;VectorX&lt;Scalar&gt;&gt;&gt; error_vectors {environment.<a class="code" href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html#a93c1f0bb1a00de972b2602acf17cae59">error_vectors</a>.end() - n, environment.<a class="code" href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html#a93c1f0bb1a00de972b2602acf17cae59">error_vectors</a>.end()};  <span class="comment">// The n-th last alpha error vectors.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keyword">const</span> std::vector&lt;ScalarUSQOneElectronOperator&lt;Scalar&gt;&gt; fock_matrices {environment.<a class="code" href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html#a0f5f070c7bc52ea98ed1d89117104c99">fock_matrices</a>.end() - n, environment.<a class="code" href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html#a0f5f070c7bc52ea98ed1d89117104c99">fock_matrices</a>.end()};  <span class="comment">// The n-th last Fock matrices.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        std::vector&lt;SquareMatrix&lt;Scalar&gt;&gt; alpha_fock_matrices;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        std::vector&lt;SquareMatrix&lt;Scalar&gt;&gt; beta_fock_matrices;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; fock_matrices.size(); i++) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            alpha_fock_matrices.push_back(fock_matrices[i].<a class="code" href="namespace_g_q_c_p.html#ac6f590924cfbbf11847a4ce174fe6e4fa834333af336cb600f3164028970f7ac6">alpha</a>().parameters());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            beta_fock_matrices.push_back(fock_matrices[i].<a class="code" href="namespace_g_q_c_p.html#ac6f590924cfbbf11847a4ce174fe6e4fa072822a43e425c974197a1c86efb36c5">beta</a>().parameters());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        std::vector&lt;VectorX&lt;Scalar&gt;&gt; alpha_error_vectors;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        std::vector&lt;VectorX&lt;Scalar&gt;&gt; beta_error_vectors;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; error_vectors.size(); i++) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            alpha_error_vectors.push_back(error_vectors[i].<a class="code" href="namespace_g_q_c_p.html#ac6f590924cfbbf11847a4ce174fe6e4fa834333af336cb600f3164028970f7ac6">alpha</a>());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            beta_error_vectors.push_back(error_vectors[i].<a class="code" href="namespace_g_q_c_p.html#ac6f590924cfbbf11847a4ce174fe6e4fa072822a43e425c974197a1c86efb36c5">beta</a>());</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="comment">// Calculate the accelerated Fock matrices and do a diagonalization step on them.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> F_alpha_accelerated = this-&gt;diis.<a class="code" href="class_g_q_c_p_1_1_d_i_i_s.html#afc4b6a0b711eafeeb3740780eb7f8a9f">accelerate</a>(alpha_fock_matrices, alpha_error_vectors);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> F_beta_accelerated = this-&gt;diis.<a class="code" href="class_g_q_c_p_1_1_d_i_i_s.html#afc4b6a0b711eafeeb3740780eb7f8a9f">accelerate</a>(beta_fock_matrices, beta_error_vectors);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_g_q_c_p_1_1_u_s_q_one_electron_operator.html">ScalarUSQOneElectronOperator&lt;Scalar&gt;</a> F_accelerated {F_alpha_accelerated, F_beta_accelerated};</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        environment.<a class="code" href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html#a0f5f070c7bc52ea98ed1d89117104c99">fock_matrices</a>.push_back(F_accelerated);  <span class="comment">// The diagonalization step can only read from the environment.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_diagonalization.html">UHFFockMatrixDiagonalization&lt;Scalar&gt;</a>().<a class="code" href="class_g_q_c_p_1_1_u_h_f_fock_matrix_diagonalization.html#ae358b2b13f6dcc5299745573298be194">execute</a>(environment);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">// The accelerated/extrapolated Fock matrices should not be used in further extrapolation steps, as they are not created from a density matrix.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        environment.<a class="code" href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html#a0f5f070c7bc52ea98ed1d89117104c99">fock_matrices</a>.pop_back();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;};</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}  <span class="comment">// namespace GQCP</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s_html_a3c5cab15d8afe08c7614d893d0aabadd"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#a3c5cab15d8afe08c7614d893d0aabadd">GQCP::UHFFockMatrixDIIS::Scalar</a></div><div class="ttdeci">_Scalar Scalar</div><div class="ttdef"><b>Definition:</b> UHFFockMatrixDIIS.hpp:43</div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_s_c_f_environment_html_a93c1f0bb1a00de972b2602acf17cae59"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html#a93c1f0bb1a00de972b2602acf17cae59">GQCP::UHFSCFEnvironment::error_vectors</a></div><div class="ttdeci">std::deque&lt; SpinResolved&lt; VectorX&lt; Scalar &gt; &gt; &gt; error_vectors</div><div class="ttdef"><b>Definition:</b> UHFSCFEnvironment.hpp:65</div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_d_i_i_s_html_afc4b6a0b711eafeeb3740780eb7f8a9f"><div class="ttname"><a href="class_g_q_c_p_1_1_d_i_i_s.html#afc4b6a0b711eafeeb3740780eb7f8a9f">GQCP::DIIS::accelerate</a></div><div class="ttdeci">Subject accelerate(const std::vector&lt; Subject &gt; &amp;subjects, const std::vector&lt; VectorX&lt; Scalar &gt;&gt; &amp;errors) const</div><div class="ttdef"><b>Definition:</b> DIIS.hpp:52</div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_step_html"><div class="ttname"><a href="class_g_q_c_p_1_1_step.html">GQCP::Step</a></div><div class="ttdef"><b>Definition:</b> Step.hpp:37</div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_s_c_f_environment_html_a0f5f070c7bc52ea98ed1d89117104c99"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html#a0f5f070c7bc52ea98ed1d89117104c99">GQCP::UHFSCFEnvironment::fock_matrices</a></div><div class="ttdeci">std::deque&lt; ScalarUSQOneElectronOperator&lt; Scalar &gt; &gt; fock_matrices</div><div class="ttdef"><b>Definition:</b> UHFSCFEnvironment.hpp:63</div></div>
<div class="ttc" id="anamespace_g_q_c_p_html_ac6f590924cfbbf11847a4ce174fe6e4fa072822a43e425c974197a1c86efb36c5"><div class="ttname"><a href="namespace_g_q_c_p.html#ac6f590924cfbbf11847a4ce174fe6e4fa072822a43e425c974197a1c86efb36c5">GQCP::beta</a></div><div class="ttdeci">@ beta</div><div class="ttdef"><b>Definition:</b> Spin.hpp:29</div></div>
<div class="ttc" id="anamespace_g_q_c_p_html"><div class="ttname"><a href="namespace_g_q_c_p.html">GQCP</a></div><div class="ttdef"><b>Definition:</b> BaseOneElectronIntegralBuffer.hpp:25</div></div>
<div class="ttc" id="a_q_c_model_2_h_f_2_u_h_f_8hpp_html"><div class="ttname"><a href="_q_c_model_2_h_f_2_u_h_f_8hpp.html">UHF.hpp</a></div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_fock_matrix_diagonalization_html_ae358b2b13f6dcc5299745573298be194"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_fock_matrix_diagonalization.html#ae358b2b13f6dcc5299745573298be194">GQCP::UHFFockMatrixDiagonalization::execute</a></div><div class="ttdeci">void execute(Environment &amp;environment) override</div><div class="ttdef"><b>Definition:</b> UHFFockMatrixDiagonalization.hpp:62</div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s_html"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html">GQCP::UHFFockMatrixDIIS</a></div><div class="ttdef"><b>Definition:</b> UHFFockMatrixDIIS.hpp:40</div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_fock_matrix_diagonalization_html"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_fock_matrix_diagonalization.html">GQCP::UHFFockMatrixDiagonalization</a></div><div class="ttdef"><b>Definition:</b> UHFFockMatrixDiagonalization.hpp:37</div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_d_i_i_s_html"><div class="ttname"><a href="class_g_q_c_p_1_1_d_i_i_s.html">GQCP::DIIS&lt; Scalar &gt;</a></div></div>
<div class="ttc" id="a_u_h_f_fock_matrix_diagonalization_8hpp_html"><div class="ttname"><a href="_u_h_f_fock_matrix_diagonalization_8hpp.html">UHFFockMatrixDiagonalization.hpp</a></div></div>
<div class="ttc" id="a_u_h_f_s_c_f_environment_8hpp_html"><div class="ttname"><a href="_u_h_f_s_c_f_environment_8hpp.html">UHFSCFEnvironment.hpp</a></div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s_html_ad2bdf1e167babd76b3d5a6b6c4c0f357"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#ad2bdf1e167babd76b3d5a6b6c4c0f357">GQCP::UHFFockMatrixDIIS::UHFFockMatrixDIIS</a></div><div class="ttdeci">UHFFockMatrixDIIS(const size_t minimum_subspace_dimension=6, const size_t maximum_subspace_dimension=6)</div><div class="ttdef"><b>Definition:</b> UHFFockMatrixDIIS.hpp:63</div></div>
<div class="ttc" id="a_d_i_i_s_8hpp_html"><div class="ttname"><a href="_d_i_i_s_8hpp.html">DIIS.hpp</a></div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_s_q_one_electron_operator_html"><div class="ttname"><a href="class_g_q_c_p_1_1_u_s_q_one_electron_operator.html">GQCP::USQOneElectronOperator</a></div><div class="ttdef"><b>Definition:</b> USQOneElectronOperator.hpp:48</div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_s_c_f_environment_html"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_s_c_f_environment.html">GQCP::UHFSCFEnvironment</a></div><div class="ttdef"><b>Definition:</b> UHFSCFEnvironment.hpp:45</div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_fock_matrix_calculation_html_a3477f32fa104205808148d9dd5e156fa"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_fock_matrix_calculation.html#a3477f32fa104205808148d9dd5e156fa">GQCP::UHFFockMatrixCalculation::execute</a></div><div class="ttdeci">void execute(Environment &amp;environment) override</div><div class="ttdef"><b>Definition:</b> UHFFockMatrixCalculation.hpp:61</div></div>
<div class="ttc" id="a_step_8hpp_html"><div class="ttname"><a href="_step_8hpp.html">Step.hpp</a></div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_fock_matrix_calculation_html"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_fock_matrix_calculation.html">GQCP::UHFFockMatrixCalculation</a></div><div class="ttdef"><b>Definition:</b> UHFFockMatrixCalculation.hpp:36</div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s_html_a0e3a95de68060c280dc8c43e108cc86a"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#a0e3a95de68060c280dc8c43e108cc86a">GQCP::UHFFockMatrixDIIS::description</a></div><div class="ttdeci">std::string description() const override</div><div class="ttdef"><b>Definition:</b> UHFFockMatrixDIIS.hpp:75</div></div>
<div class="ttc" id="anamespace_g_q_c_p_html_ac6f590924cfbbf11847a4ce174fe6e4fa834333af336cb600f3164028970f7ac6"><div class="ttname"><a href="namespace_g_q_c_p.html#ac6f590924cfbbf11847a4ce174fe6e4fa834333af336cb600f3164028970f7ac6">GQCP::alpha</a></div><div class="ttdeci">@ alpha</div><div class="ttdef"><b>Definition:</b> Spin.hpp:28</div></div>
<div class="ttc" id="aclass_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s_html_a207ae64b829294f7b15481f7cbd17990"><div class="ttname"><a href="class_g_q_c_p_1_1_u_h_f_fock_matrix_d_i_i_s.html#a207ae64b829294f7b15481f7cbd17990">GQCP::UHFFockMatrixDIIS::execute</a></div><div class="ttdeci">void execute(Environment &amp;environment) override</div><div class="ttdef"><b>Definition:</b> UHFFockMatrixDIIS.hpp:85</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
