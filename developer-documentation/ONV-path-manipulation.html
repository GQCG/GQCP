

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Manipulating ONVs and their addresses</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'developer-documentation/ONV-path-manipulation';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GQCP devops" href="devops.html" />
    <link rel="prev" title="Introduction for developers" href="introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../landing-page.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../landing-page.html">
                    The Ghent Quantum Chemistry Package
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../user-documentation/installing-gqcp.html">Installing GQCP(y)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-documentation/using-gqcp.html">Using GQCP(y)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorial/introduction.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/molecules.html">Molecules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/orbital-bases.html">Orbital bases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/quantum-chemical-methods.html">Quantum chemical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/quantum-chemical-models.html">Quantum chemical models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/use-cases.html">Common use cases</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../examples/Spinor-bases.html">Spinor bases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/RHF-dipole-moments.html">Calculating the RHF dipole moment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/UHF-calculations.html">UHF SCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Custom-algorithms-showcase-CUHF.html">Custom algorithms showcase - CUHF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/R-U-GHF-overlaps.html">Overlaps between R/U/GHF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/HF-Stability.html">Checking the Hartree-Fock Stability conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Following-internal-GHF-instabilities.html">Following internal instabilities in GHF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/ONVPath.html">ONV path manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/DOCI.html">DOCI calculations</a></li>



<li class="toctree-l1"><a class="reference internal" href="../examples/OO-DOCI.html">OO-DOCI calculations</a></li>


<li class="toctree-l1"><a class="reference internal" href="../examples/FCI.html">Molecular FCI calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Hubbard.html">Hubbard calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Hubbard-Domains.html">Set up two different domains</a></li>


<li class="toctree-l1"><a class="reference internal" href="../examples/AP1roG-calculations.html">AP1roG calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/CCSD.html">CCSD calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Mulliken-population.html">Calculating the Mulliken population</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Biorthogonalization.html">Setup the basis and the overlap</a></li>


<li class="toctree-l1"><a class="reference internal" href="../examples/NOCI.html">Non Orthogonal Configuration Interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Magnetic-inducibility.html">The ipsocentric magnetic inducibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Integrals-over-GTOs.html">Calculating integrals over GTOs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/London-integrals.html">Gauge-origin independence for London kinetic integrals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Mean-field-magnetic.html">Mean-field calculations in magnetic fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Mulliken-constrained-CI.html">Mulliken constrained CI calculations</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="style-guide.html">GQCP Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction for developers</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Manipulating ONVs and their addresses</a></li>
<li class="toctree-l1"><a class="reference internal" href="devops.html">GQCP devops</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/troubleshooting.html">Troubleshooting guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/citations.html">Academic references</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/api.html">API</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Blog posts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../blog/2020-11-30-RSDD.html">GQCP appears in RSDD2020</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/developer-documentation/ONV-path-manipulation.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Manipulating ONVs and their addresses</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-electron-excitations">One-electron excitations</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="section" id="manipulating-onvs-and-their-addresses">
<h1>Manipulating ONVs and their addresses<a class="headerlink" href="#manipulating-onvs-and-their-addresses" title="Permalink to this heading">#</a></h1>
<p>Understanding the inner workings of a low-level CI code can be daunting, mainly because bit string manipulations can be very hard to understand without any guidance. This section should help aspiring developers how GQCP deals with the manipulation of ONV’s (occupation number vectors) and their path representation in an addressing scheme.</p>
<blockquote>
<div><p>Note: In order to understand the following section, it is necessary that you understand the theory first, since the code tries to follow the theory as closely as possible. To brush up on CI algorithms, ONVs and addressing schemes, we highly recommend chapter 11 in the ‘purple bible’ <a class="reference external" href="https://onlinelibrary.wiley.com/doi/book/10.1002/9781119019572">Molecular Electronic‐Structure Theory</a> by Helgaker, Jørgensen and Olsen.</p>
</div></blockquote>
<div class="section" id="one-electron-excitations">
<h2>One-electron excitations<a class="headerlink" href="#one-electron-excitations" title="Permalink to this heading">#</a></h2>
<p>ONV path manipulations are intuitively described using a second quantization approach, which GQCP’s API sticks to as closely as possible by providing a class <code class="docutils literal notranslate"><span class="pre">ONVPath</span></code>. To manipulate an ONV path, we use the elementary second quantization operators to annihilate or create arcs that represent occupied orbitals. In an ONV path, a diagonal arc represents an occupied orbital, while a vertical arc represents an unoccupied orbital. As an example, we will use the path of the ONV <code class="docutils literal notranslate"><span class="pre">|10110&gt;</span></code>.</p>
<!--DOCUSAURUS_CODE_TABS-->
<!--Python-->
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up a F(5,3) Fock space.</span>
<span class="n">onv_basis</span> <span class="o">=</span> <span class="n">gqcpy</span><span class="o">.</span><span class="n">SpinUnresolvedONVBasis</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">onv</span> <span class="o">=</span> <span class="n">gqcpy</span><span class="o">.</span><span class="n">SpinUnresolvedONV</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">onv_path</span> <span class="o">=</span> <span class="n">gqcpy</span><span class="o">.</span><span class="n">ONVPath</span><span class="p">(</span><span class="n">onv_basis</span><span class="p">,</span> <span class="n">onv</span><span class="p">)</span>
</pre></div>
</div>
<!--C++-->
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Set up a F(5,3) Fock space.</span>
<span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>

<span class="k">const</span><span class="w"> </span><span class="n">GQCP</span><span class="o">::</span><span class="n">SpinUnresolvedONVBasis</span><span class="w"> </span><span class="n">onv_basis</span><span class="w"> </span><span class="p">{</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">};</span>

<span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GQCP</span><span class="o">::</span><span class="n">SpinUnresolvedONV</span><span class="o">::</span><span class="n">FromOccupiedIndices</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w">  </span><span class="c1">// |10110&gt;</span>
<span class="n">GQCP</span><span class="o">::</span><span class="n">ONVPath</span><span class="w"> </span><span class="n">onv_path</span><span class="w"> </span><span class="p">{</span><span class="n">onv_basis</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">};</span>
</pre></div>
</div>
<!--END_DOCUSAURUS_CODE_TABS-->
<p>Graphically, the state of the corresponding <code class="docutils literal notranslate"><span class="pre">ONVPath</span></code> may be pictorially represented as:</p>
<p><img alt="init_path" src="../_images/ONVPath_10110.png" /></p>
<p>Since the address of an ONV is the sum of its diagonal arc weights, the address for <code class="docutils literal notranslate"><span class="pre">|10110&gt;</span></code> is <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p>
<blockquote>
<div><p>Notice the blue dot at the coordinate [0, 0]. This signifies that no annihilations on the ONV have taken place.</p>
</div></blockquote>
<p>The function <code class="docutils literal notranslate"><span class="pre">annihilate()</span></code> removes the diagonal arc starting at the given coordinate in the ONV path.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">*  Annihilate the diagonal arc that starts at the coordinate (q,n).</span>
<span class="cm">* </span>
<span class="cm">*  @param q        the index of the orbital that should be annihilated</span>
<span class="cm">*  @param n        the number of electrons in the ONV/path up to the orbital index q</span>
<span class="cm">*/</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">ONVPath::annihilate</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// During annihilation, we&#39;re removing an arc, so we&#39;ll have to update the current address by removing the corresponding arc weight.</span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">m_address</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">onv_basis</span><span class="p">.</span><span class="n">arcWeight</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Update the next possible creation index. Since we&#39;re always constructing paths from the top-left to the bottom-right, we&#39;re only considering creation indices p &gt; q.</span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There are three diagonal arcs (starting at [0, 0], [2, 1] and [3, 2]), which are the coordinates where <code class="docutils literal notranslate"><span class="pre">annihilate()</span></code> can remove an electron. Let’s say we <code class="docutils literal notranslate"><span class="pre">annihilate(0,</span> <span class="pre">0)</span></code>. The diagonal arc starting at [0, 0] will then become a vertical arc, resulting in a new, <em>open</em> path, related to the ONV <code class="docutils literal notranslate"><span class="pre">|00110&gt;</span></code></p>
<blockquote>
<div><p>Note: An <em>open</em> path represents the situation where the associated ONV belongs to a Fock space with less electrons.</p>
</div></blockquote>
<!--DOCUSAURUS_CODE_TABS-->
<!--Python-->
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Annihilate the electron in the orbital with index 0</span>
<span class="n">onv_path</span><span class="o">.</span><span class="n">annihilate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<!--C++-->
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Annihilate the electron in the orbital with index 0.</span>
<span class="n">onv_path</span><span class="p">.</span><span class="n">annihilate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<!--END_DOCUSAURUS_CODE_TABS-->
<p><img alt="first_annihilate" src="../_images/ONVPath_00110_1.png" /></p>
<p>Since we have removed a diagonal arc with weight <code class="docutils literal notranslate"><span class="pre">1</span></code>, the current address of this open path is <code class="docutils literal notranslate"><span class="pre">2</span></code>. To <em>close</em> the current path, we can use the <code class="docutils literal notranslate"><span class="pre">create()</span></code> function.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">*  Create the diagonal arc that starts at the coordinate (p, n).</span>
<span class="cm">* </span>
<span class="cm">*  @param p        the index of the orbital that should be created</span>
<span class="cm">*  @param n        the number of electrons in the ONV/path up to the orbital index q, prior to the creation</span>
<span class="cm">*/</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">ONVPath::create</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// During creation, we&#39;re adding an arc, so we&#39;ll have to update the current address by adding the corresponding arc weight.</span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">m_address</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">onv_basis</span><span class="p">.</span><span class="n">arcWeight</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this particular case, the path can be closed by creating at coordinate [1, 0], resulting in a new ONV: <code class="docutils literal notranslate"><span class="pre">|01110&gt;</span></code>.</p>
<!--DOCUSAURUS_CODE_TABS-->
<!--Python-->
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an electron in the orbital with index 1</span>
<span class="n">onv_path</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<!--C++-->
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create an electron in the orbital with index 1.</span>
<span class="n">onv_path</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<!--END_DOCUSAURUS_CODE_TABS-->
<p><img alt="first_create" src="../_images/ONVPath_01110.png" /></p>
<p>This was not the only way to close the path related to the ONV <code class="docutils literal notranslate"><span class="pre">|00110&gt;</span></code>. Clearly, it is possible to create an electron in the orbital with index <code class="docutils literal notranslate"><span class="pre">4</span></code>. In order to update the path’s state, we’ll have to shift diagonal arcs (indicating occupied orbitals) to the left until a vertical arc is encountered to close the gap. For this purpose, GQCP offers the API <code class="docutils literal notranslate"><span class="pre">leftTranslateDiagonalArc()</span></code>.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">  *  Translate the diagonal arc that starts at the coordinate (p, n) to the left.</span>
<span class="cm">  * </span>
<span class="cm">  *  @param p        the index of the orbital that should be annihilated</span>
<span class="cm">  *  @param n        the number of electrons in the ONV/path up to the orbital index p</span>
<span class="cm">  */</span>
<span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">ONVPath::leftTranslateDiagonalArc</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">     </span><span class="c1">// Translating a diagonal arc can be rewritten as an annihilation, followed by a creation.</span>
<span class="w">     </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">annihilate</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
<span class="w">     </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="w">     </span><span class="c1">// Since a left-translation describes the process of &#39;encountering an electron/occupied orbital&#39;, the sign factor should be updated according to the fermionic anti-commutation rules.</span>
<span class="w">     </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">m_sign</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<blockquote>
<div><p>Note: <code class="docutils literal notranslate"><span class="pre">leftTranslateDiagonalArc()</span></code> keep track of the overall sign of the annihilations and creations due to the fermionic anti-commutation relations.</p>
</div></blockquote>
<p>The initial situation may be described in the following figure, on the left.</p>
<p><img alt="first_annihilate_shift" src="../_images/ONVPath_00110_2_3_side.png" /></p>
<blockquote>
<div><p>Notice the blue dot at the coordinate [2, 0]. This means that the path’s state is now ready to be modified starting at the orbital with index <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p>
</div></blockquote>
<p>We’ll get started by moving the diagonal arc that starts at [2, 1], yielding the situation on the right.</p>
<!--DOCUSAURUS_CODE_TABS-->
<!--Python-->
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Translate the diagonal arc that starts at (2, 1) to (2, 0).</span>
<span class="n">onv_path</span><span class="o">.</span><span class="n">leftTranslateDiagonalArc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<!--C++-->
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Translate the diagonal arc that starts at (2, 1) to (2, 0).</span>
<span class="n">onv_path</span><span class="p">.</span><span class="n">leftTranslateDiagonalArc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<!--END_DOCUSAURUS_CODE_TABS-->
<p>Since we have removed an arc with weight <code class="docutils literal notranslate"><span class="pre">1</span></code>, and created one with weight <code class="docutils literal notranslate"><span class="pre">2</span></code>, the current address of this open path is <code class="docutils literal notranslate"><span class="pre">3</span></code>. After this translation, the situation is still very similar. The next possible creation index is still an occupied index, so we’ll need to perform another translation.</p>
<!--DOCUSAURUS_CODE_TABS-->
<!--Python-->
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Translate the diagonal arc that starts at (3, 2) to (3, 1).</span>
<span class="n">onv_path</span><span class="o">.</span><span class="n">leftTranslateDiagonalArc</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<!--C++-->
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Translate the diagonal arc that starts at (3, 2) to (3, 1).</span>
<span class="n">onv_path</span><span class="p">.</span><span class="n">leftTranslateDiagonalArc</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<!--END_DOCUSAURUS_CODE_TABS-->
<p>Instead of translating the occupied arcs to the left manually, there is also the possibility to keep translating occupied arcs until an unoccupied, vertical ar is found. This is done with <code class="docutils literal notranslate"><span class="pre">leftTranslateDiagonalArcUntilVerticalArc()</span></code>. This function translates diagonal arcs using the <code class="docutils literal notranslate"><span class="pre">leftTranslateDiagonalArc()</span></code> function, until an unoccupied creation index is found.</p>
<!--DOCUSAURUS_CODE_TABS-->
<!--Python-->
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Keep translating diagonal arcs to the left, until an unoccupied index is found.</span>
<span class="n">onv_path</span><span class="o">.</span><span class="n">leftTranslateDiagonalArcUntilVerticalArc</span><span class="p">()</span>
</pre></div>
</div>
<!--C++-->
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Keep translating diagonal arcs to the left, until an unoccupied index is found.</span>
<span class="n">onv_path</span><span class="p">.</span><span class="n">leftTranslateDiagonalArcUntilVerticalArc</span><span class="p">();</span>
</pre></div>
</div>
<!--END_DOCUSAURUS_CODE_TABS-->
<p>This will lead to the exact same ONV as performing the two <code class="docutils literal notranslate"><span class="pre">leftTranslateDiagonalArc()</span></code> functions separately.</p>
<p><img alt="second_shift" src="../_images/ONVPath_00110_4.png" /></p>
<p>Since we’ve removed an arc with weight <code class="docutils literal notranslate"><span class="pre">1</span></code> and created one with weight <code class="docutils literal notranslate"><span class="pre">3</span></code>, the address of the resulting open path is <code class="docutils literal notranslate"><span class="pre">5</span></code>. Finally, we may close the path by creating an electron, since the next index now refers to an unoccupied orbital. The weight of the related diagonal arc is <code class="docutils literal notranslate"><span class="pre">4</span></code>, so finally the address of the resulting ONV is <code class="docutils literal notranslate"><span class="pre">9</span></code>.</p>
<!--DOCUSAURUS_CODE_TABS-->
<!--Python-->
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an electron in the orbital with index 4.</span>
<span class="n">onv_path</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<!--C++-->
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create an electron in the orbital with index 4.</span>
<span class="n">onv_path</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<!--END_DOCUSAURUS_CODE_TABS-->
<p><img alt="final_creation" src="../_images/ONVPath_00111.png" /></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "GQCG/GQCP",
            ref: "develop",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./developer-documentation"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="introduction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction for developers</p>
      </div>
    </a>
    <a class="right-next"
       href="devops.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">GQCP devops</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-electron-excitations">One-electron excitations</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Ghent Quantum Chemistry Group
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2017-2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>